(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[2529],{42529:function(C,s,r){"use strict";r.r(s);var c=r(11849),a=r(2824),e=r(67294),d=r(50213),m=r(88922),p=r(85893),B=function(h){var W=h.initialScale,O=W===void 0?.2:W,D=h.thick,g=D===void 0?20:D,L=h.space,M=L===void 0?100:L,w=h.rectWidth,v=w===void 0?1920:w,l=h.rectHeight,u=l===void 0?1080:l,o=h.initialLines,E=o===void 0?{h:[],v:[]}:o,f=h.initialRulerSize,S=f===void 0?{width:582,height:482}:f,_=h.initialStart,T=_===void 0?{startX:0,startY:0}:_,K=h.children,U=h.onScaleChange,n=(0,e.useRef)(null),b=(0,e.useRef)(null),fe=(0,m.Z)(n),de=(0,e.useState)(O),x=(0,a.Z)(de,2),P=x[0],$=x[1],ve=(0,e.useState)(!0),j=(0,a.Z)(ve,2),k=j[0],_e=j[1],he=(0,e.useState)(!0),F=(0,a.Z)(he,2),H=F[0],Ee=F[1],me=(0,e.useState)(!0),N=(0,a.Z)(me,2),G=N[0],Se=N[1],Re=(0,e.useState)(T),J=(0,a.Z)(Re,2),Q=J[0],ge=J[1],we=(0,e.useState)(S),V=(0,a.Z)(we,2),q=V[0],pe=V[1],Le=(0,e.useState)(E),ee=(0,a.Z)(Le,2),te=ee[0],ye=ee[1],Ce=(0,e.useState)(),De=(0,a.Z)(Ce,2),z=De[1],Me=(0,e.useState)({top:0,left:0}),re=(0,a.Z)(Me,2),A=re[0],We=re[1],X=(0,e.useRef)(!1),Oe=function(t){ye(t)},Te=function(){Se(!G)},Pe=function(){_e(!k)},ne=function(){var t=document.querySelector("#screens").getBoundingClientRect(),i=document.querySelector("#canvas").getBoundingClientRect(),y=(t.left+g-i.left)/P,Z=(t.top+g-i.top)/P;ge({startX:y,startY:Z})},ae=function(t){return(t.ctrlKey||t.metaKey)&&(t.preventDefault(),$(function(i){var y=parseFloat(Math.max(.2,i-t.deltaY/3e3).toFixed(2));return y})),!1},Ae=function(){Ee(!H)},Ze=function(){var t,i,y=(b==null||(t=b.current)===null||t===void 0?void 0:t.getBoundingClientRect().width)||0,Z=(n==null||(i=n.current)===null||i===void 0?void 0:i.getBoundingClientRect().width)||0;n.current&&(n.current.scrollLeft=y/2-Z/2)},Y=function(){var t,i,y=(t=document.querySelector("#dashboard-edit-panel-operate"))===null||t===void 0?void 0:t.getBoundingClientRect();if(y){var Z=1;pe({width:y.width-g-Z,height:y.height-g-Z})}var le=(n==null||(i=n.current)===null||i===void 0?void 0:i.getBoundingClientRect().width)||0;$(Math.min((v-M)/le,(le-M)/v)),Ze()},ie=function(t){t.keyCode===32&&(t.preventDefault(),X.current=!0,n.current&&(n.current.style.cursor="pointer"))},ue=function(t){t.keyCode===32&&(t.preventDefault(),X.current=!1,n.current&&(n.current.style.cursor="auto"))},oe=function(t){t.buttons===1&&X.current&&(t.preventDefault(),z(function(i){return i!=null&&i.deltaX&&i!==null&&i!==void 0&&i.deltaY&&We({left:t.pageX-i.deltaX,top:t.pageY-i.deltaY}),{deltaX:t.pageX,deltaY:t.pageY}}))},se=function(t){t.button===0&&(t.preventDefault(),z({deltaX:t.pageX,deltaY:t.pageY}))},ce=function(t){t.button===0&&(t.preventDefault(),z({deltaX:void 0,deltaY:void 0}))};(0,e.useEffect)(function(){return n.current.addEventListener("wheel",ae,{passive:!1}),window.addEventListener("resize",Y),window.addEventListener("keypress",ie),window.addEventListener("keyup",ue),n.current&&(n.current.addEventListener("mousedown",se),n.current.addEventListener("mousemove",oe),n.current.addEventListener("mouseup",ce)),function(){window.removeEventListener("resize",Y),window.removeEventListener("keypress",ie),window.removeEventListener("keyup",ue),n.current&&(n.current.removeEventListener("mousedown",se),n.current.removeEventListener("mousemove",oe),n.current.removeEventListener("mouseup",ce))}},[]),(0,e.useEffect)(function(){Y()},[fe]),(0,e.useEffect)(function(){n.current&&(n.current.scrollLeft=n.current.scrollLeft-((A==null?void 0:A.left)||0),n.current.scrollTop=n.current.scrollTop-((A==null?void 0:A.top)||0))},[A]),(0,e.useEffect)(function(){ne(),U==null||U(P)},[P]);var Be={width:v,height:u,transform:"scale(".concat(P,", ").concat(P,") translateX(-50%)"),transformOrigin:"0 0"},Ue={x:0,y:0,width:v,height:u};return(0,p.jsxs)(e.Fragment,{children:[k?(0,p.jsx)(d.Z,{thick:g,scale:P,width:q.width,height:q.height,startX:Q.startX,startY:Q.startY,shadow:Ue,horLineArr:te.h,verLineArr:te.v,handleLine:Oe,cornerActive:H,onCornerClick:Ae,palette:{bgColor:"#1d1f26",longfgColor:"#fff",shortfgColor:"#fff",fontColor:"#fff",shadowColor:"transparent",lineColor:"red",borderColor:"#1d1f26"},isOpenMenuFeature:!0,handleShowRuler:Pe,isShowReferLine:G,handleShowReferLine:Te}):null,(0,p.jsx)("div",{ref:n,id:"screens",onScroll:ne,onWheel:ae,children:(0,p.jsx)("div",{ref:b,className:"screen-container",children:(0,p.jsx)("div",{id:"canvas",style:(0,c.Z)({},Be),children:K})})})]})};s.default=B},3930:function(C,s,r){"use strict";var c=r(67294);function a(e){var d=(0,c.useRef)(e);return d.current=e,d}s.Z=a},88922:function(C,s,r){"use strict";r.d(s,{Z:function(){return v}});var c=r(91033),a=r(67294),e=r(45210),d=function(l,u){var o=typeof Symbol=="function"&&l[Symbol.iterator];if(!o)return l;var E=o.call(l),f,S=[],_;try{for(;(u===void 0||u-- >0)&&!(f=E.next()).done;)S.push(f.value)}catch(T){_={error:T}}finally{try{f&&!f.done&&(o=E.return)&&o.call(E)}finally{if(_)throw _.error}}return S};function m(l){var u=(0,a.useRef)(0),o=d((0,a.useState)(l),2),E=o[0],f=o[1],S=(0,a.useCallback)(function(_){cancelAnimationFrame(u.current),u.current=requestAnimationFrame(function(){f(_)})},[]);return(0,e.Z)(function(){cancelAnimationFrame(u.current)}),[E,S]}var p=m,B=r(48002),I=r(52982),h=r(59682),W=r(40351),O=(0,W.Z)(a.useLayoutEffect),D=O,g=I.Z?D:h.Z,L=g,M=function(l,u){var o=typeof Symbol=="function"&&l[Symbol.iterator];if(!o)return l;var E=o.call(l),f,S=[],_;try{for(;(u===void 0||u-- >0)&&!(f=E.next()).done;)S.push(f.value)}catch(T){_={error:T}}finally{try{f&&!f.done&&(o=E.return)&&o.call(E)}finally{if(_)throw _.error}}return S};function w(l){var u=M(p(),2),o=u[0],E=u[1];return L(function(){var f=(0,B.n)(l);if(!!f){var S=new c.Z(function(_){_.forEach(function(T){var K=T.target,U=K.clientWidth,n=K.clientHeight;E({width:U,height:n})})});return S.observe(f),function(){S.disconnect()}}},[],l),o}var v=w},45210:function(C,s,r){"use strict";var c=r(67294),a=r(3930),e=function(m){var p=(0,a.Z)(m);(0,c.useEffect)(function(){return function(){p.current()}},[])};s.Z=e},40351:function(C,s,r){"use strict";var c=r(67294),a=r(45210),e=r(8224),d=r(48002),m=function(B){var I=function(W,O,D){var g=(0,c.useRef)(!1),L=(0,c.useRef)([]),M=(0,c.useRef)([]),w=(0,c.useRef)();B(function(){var v,l=Array.isArray(D)?D:[D],u=l.map(function(o){return(0,d.n)(o)});g.current||(g.current=!0,L.current=u,M.current=O,w.current=W()),(u.length!==L.current.length||!(0,e.Z)(u,L.current)||!(0,e.Z)(O,M.current))&&((v=w.current)===null||v===void 0||v.call(w),L.current=u,M.current=O,w.current=W())}),(0,a.Z)(function(){var v;(v=w.current)===null||v===void 0||v.call(w),g.current=!1})};return I};s.Z=m},8224:function(C,s,r){"use strict";r.d(s,{Z:function(){return c}});function c(a,e){if(a===e)return!0;for(var d=0;d<a.length;d++)if(!Object.is(a[d],e[d]))return!1;return!0}},48002:function(C,s,r){"use strict";r.d(s,{n:function(){return a}});var c=r(52982);function a(e,d){if(!!c.Z){if(!e)return d;var m;return typeof e=="function"?m=e():"current"in e?m=e.current:m=e,m}}},52982:function(C,s){"use strict";var r=!!(typeof window!="undefined"&&window.document&&window.document.createElement);s.Z=r},59682:function(C,s,r){"use strict";var c=r(67294),a=r(40351),e=(0,a.Z)(c.useEffect);s.Z=e}}]);
