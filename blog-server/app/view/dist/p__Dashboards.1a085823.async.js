(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[3619],{96113:function(X,K,e){"use strict";e.d(K,{YK:function(){return J},sI:function(){return f},JR:function(){return V},ri:function(){return N},iM:function(){return $},wJ:function(){return U}});var D=e(11849),R=e(3182),Y=e(94043),c=e.n(Y),b=e(21010);function J(o){return y.apply(this,arguments)}function y(){return y=(0,R.Z)(c().mark(function o(m){return c().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,b.WY)("/api/dashboards",{method:"GET",params:(0,D.Z)({},m)}));case 1:case"end":return t.stop()}},o)})),y.apply(this,arguments)}function f(o){return S.apply(this,arguments)}function S(){return S=(0,R.Z)(c().mark(function o(m){return c().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,b.WY)("/api/dashboards/".concat(m),{method:"GET"}));case 1:case"end":return t.stop()}},o)})),S.apply(this,arguments)}function V(o){return O.apply(this,arguments)}function O(){return O=(0,R.Z)(c().mark(function o(m){return c().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,b.WY)("/api/dashboards",{method:"POST",data:(0,D.Z)({},m)}));case 1:case"end":return t.stop()}},o)})),O.apply(this,arguments)}function N(o){return s.apply(this,arguments)}function s(){return s=(0,R.Z)(c().mark(function o(m){return c().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,b.WY)("/api/dashboards/".concat(m.id),{method:"PUT",data:(0,D.Z)({},m)}));case 1:case"end":return t.stop()}},o)})),s.apply(this,arguments)}function $(o){return A.apply(this,arguments)}function A(){return A=(0,R.Z)(c().mark(function o(m){return c().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,b.WY)("/api/dashboards/".concat(m),{method:"DELETE"}));case 1:case"end":return t.stop()}},o)})),A.apply(this,arguments)}function U(){return T.apply(this,arguments)}function T(){return T=(0,R.Z)(c().mark(function o(){return c().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",(0,b.WY)("/api/sys_dashboards",{method:"GET"}));case 1:case"end":return E.stop()}},o)})),T.apply(this,arguments)}},98638:function(X,K,e){"use strict";e.r(K),e.d(K,{default:function(){return ue}});var D=e(11849),R=e(48736),Y=e(27049),c=e(57663),b=e(71577),J=e(34792),y=e(48086),f=e(3182),S=e(2824),V=e(71194),O=e(50146),N=e(94043),s=e.n(N),$=e(67294),A=e(67265),U=e(44128),T=e(21010),o=e(20228),m=e(11382),E=e(13062),t=e(71230),le=e(89032),q=e(15746),ie=e(9715),_=e(41003),Q=e(65554),z=e(5966),ee=e(94184),re=e.n(ee),L=e(96113),a=e(85893),H=Q.Z.StepForm,ne=_.Z.Item,ae=function(M){var v=M.onChange,w=M.templates,P=w===void 0?[]:w,B=M.loading,W=(0,$.useState)(),p=(0,S.Z)(W,2),C=p[0],i=p[1],j=function(){var d=(0,f.Z)(s().mark(function h(g){return s().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,i(g.id);case 2:return l.next=4,v==null?void 0:v(g);case 4:case"end":return l.stop()}},h)}));return function(g){return d.apply(this,arguments)}}();return(0,a.jsx)(m.Z,{spinning:B,children:(0,a.jsx)(t.Z,{gutter:[16,16],className:"choose-image-row",children:P.map(function(d){return(0,a.jsx)(q.Z,{span:12,className:"choose-image-col",onClick:(0,f.Z)(s().mark(function h(){return s().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",j(d));case 1:case"end":return n.stop()}},h)})),children:(0,a.jsxs)("div",{className:"choose-image-box",children:[(0,a.jsx)("i",{className:re()("choose-image-choose-icon",{visible:d.id===C})}),(0,a.jsx)("div",{className:"img-box",children:(0,a.jsx)("img",{src:d.cover,alt:""})}),(0,a.jsx)("div",{children:d.name})]})},d.id)})})})},te=function(I){var M=I.visible,v=I.onCancel,w=(0,$.useRef)(),P=(0,$.useState)(0),B=(0,S.Z)(P,2),W=B[0],p=B[1],C=(0,$.useState)([]),i=(0,S.Z)(C,2),j=i[0],d=i[1],h=(0,T.QT)(L.wJ,{onSuccess:function(){var n=(0,f.Z)(s().mark(function r(F){return s().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:F&&(F.unshift({id:"empty",w:1920,h:1080,layouts:[],name:"\u7A7A\u767D\u6A21\u677F\uFF081920x1080\uFF09"}),d(F));case 1:case"end":return x.stop()}},r)}));function l(r){return n.apply(this,arguments)}return l}()}),g=h.loading;return(0,a.jsx)("div",{className:"dashboard-create",children:(0,a.jsxs)(Q.Z,{formRef:w,onFinish:function(){var n=(0,f.Z)(s().mark(function l(r){var F,u,x,k,G;return s().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return F=r.template,u=r.name,x=r.brief,Z.prev=1,Z.next=4,(0,L.JR)((0,D.Z)((0,D.Z)({bg_color:"#000"},F),{},{name:u,brief:x}));case 4:k=Z.sent,k.status?(y.default.success("\u521B\u5EFA\u6210\u529F"),v==null||v(),T.m8.push("/dashboards/edit/".concat(k==null||(G=k.data)===null||G===void 0?void 0:G.id))):y.default.error("\u521B\u5EFA\u5931\u8D25"),Z.next=11;break;case 8:Z.prev=8,Z.t0=Z.catch(1),y.default.error(Z.t0.message);case 11:case"end":return Z.stop()}},l,null,[[1,8]])}));return function(l){return n.apply(this,arguments)}}(),current:W,onCurrentChange:function(){var n=(0,f.Z)(s().mark(function l(r){return s().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:p(r);case 1:case"end":return u.stop()}},l)}));return function(l){return n.apply(this,arguments)}}(),stepsFormRender:function(l,r){return(0,a.jsx)(O.Z,{title:"\u521B\u5EFA\u5927\u5C4F",width:"90%",onCancel:function(){var u;v==null||v(),w==null||(u=w.current)===null||u===void 0||u.resetFields(),p(0)},visible:M,footer:r,destroyOnClose:!0,children:l})},children:[(0,a.jsx)(H,{name:"template",title:"\u521B\u5EFA\u5927\u5C4F-\u9009\u62E9\u6A21\u677F",onFinish:(0,f.Z)(s().mark(function n(){return s().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",!0);case 1:case"end":return r.stop()}},n)})),children:(0,a.jsx)(ne,{name:"template",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u8981\u4F7F\u7528\u7684\u6A21\u677F"}],children:(0,a.jsx)(ae,{templates:j,loading:g})})}),(0,a.jsxs)(H,{name:"base",title:"\u521B\u5EFA\u5927\u5C4F-\u914D\u7F6E\u4FE1\u606F",onFinish:(0,f.Z)(s().mark(function n(){return s().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",!0);case 1:case"end":return r.stop()}},n)})),children:[(0,a.jsx)(z.Z,{name:"name",label:"\u540D\u79F0",rules:[{required:!0}]}),(0,a.jsx)(z.Z,{name:"brief",label:"\u7B80\u4ECB",rules:[{required:!0}]})]})]})})},se=O.Z.confirm,ue=function(){var I=(0,$.useRef)(),M=(0,$.useState)(!1),v=(0,S.Z)(M,2),w=v[0],P=v[1],B=function(){var p=(0,f.Z)(s().mark(function C(i){return s().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(i!=null&&i.id){d.next=3;break}return y.default.error("\u4E0D\u5B58\u5728\u8BE5\u4F5C\u54C1"),d.abrupt("return");case 3:se({title:"\u63D0\u793A",content:"\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u5927\u5C4F\u5417\uFF1F",onOk:function(){var h=(0,f.Z)(s().mark(function n(){var l,r;return s().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,(0,L.iM)(i==null?void 0:i.id);case 3:l=u.sent,l.status?(y.default.success("\u5220\u9664\u6210\u529F"),I==null||(r=I.current)===null||r===void 0||r.reload()):y.default.error("\u5220\u9664\u5931\u8D25"),u.next=10;break;case 7:u.prev=7,u.t0=u.catch(0),y.default.error("\u5220\u9664\u5931\u8D25");case 10:case"end":return u.stop()}},n,null,[[0,7]])}));function g(){return h.apply(this,arguments)}return g}(),onCancel:function(){console.log("Cancel")}});case 4:case"end":return d.stop()}},C)}));return function(i){return p.apply(this,arguments)}}(),W=[{title:"ID",key:"id",dataIndex:"id",hideInSearch:!0},{title:"\u540D\u79F0",key:"name",dataIndex:"name"},{title:"\u7B80\u4ECB",key:"brief",dataIndex:"brief"},{title:"\u5BBD\u5EA6",key:"w",align:"center",dataIndex:"w"},{title:"\u9AD8\u5EA6",key:"h",align:"center",dataIndex:"h"},{title:"\u64CD\u4F5C",key:"operate",align:"center",width:200,hideInSearch:!0,render:function(C,i){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.Z,{type:"link",style:{color:"#000046"},onClick:function(){T.m8.push("/dashboards/edit/".concat(i.id))},children:"\u7F16\u8F91"}),(0,a.jsx)(Y.Z,{type:"vertical"}),(0,a.jsx)(b.Z,{type:"link",onClick:function(){window.open("/dashboards/preview/".concat(i.id))},children:"\u9884\u89C8"}),(0,a.jsx)(Y.Z,{type:"vertical"}),(0,a.jsx)("a",{style:{color:"#f50"},onClick:function(){return B(i)},children:"\u5220\u9664"})]})}}];return(0,a.jsxs)(A.ZP,{children:[(0,a.jsx)(U.ZP,{rowKey:"id",actionRef:I,search:!1,toolBarRender:function(){return[(0,a.jsx)(b.Z,{type:"primary",onClick:function(){return P(!0)},children:"\u65B0\u5EFA\u5927\u5C4F"})]},dateFormatter:"string",headerTitle:"\u5E03\u5C40\u5217\u8868",columns:W,request:function(){var p=(0,f.Z)(s().mark(function C(i,j,d){var h,g,n;return s().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,L.YK)((0,D.Z)((0,D.Z)({},i),{},{sorter:j,filter:d,page:i.current}));case 2:return n=r.sent,r.abrupt("return",{data:(n==null||(h=n.data)===null||h===void 0?void 0:h.rows)||[],success:(n==null?void 0:n.status)||!1,total:(n==null||(g=n.data)===null||g===void 0?void 0:g.count)||0});case 4:case"end":return r.stop()}},C)}));return function(C,i,j){return p.apply(this,arguments)}}()}),(0,a.jsx)(te,{visible:w,onCancel:function(){P(!1)}})]})}}}]);
